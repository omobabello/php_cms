function deleteService(e){app.deleteService(e)}var app=new Vue({el:"#app",data:{shrinkTable:!1,title:"",description:"",details:"",service_image:"",message:"",b_message:"",b_class:"",progress:0,services:"",banner:"",hasBanner:!1},methods:{changeFile(e,t){"banner"==t&&(this.banner=e.target.files[0]),"service"==t&&(this.service_image=e.target.files[0])},changeBanner(){this.hasBanner=!1},uploadBanner(){if(this.valid_file(this.banner,10)){this.b_message="";const e={onUploadProgress:function(e){app.progress=Math.round(e.loaded/e.total*100)}};let t=this.toFormData({image:this.banner});axios.post("http://localhost/gym_cms/index.php/UploadBanner/service",t,e).then(e=>{e.data.status?(this.progress=0,this.banner=e.data.file,this.hasBanner=!0):(this.b_message=e.data.message,this.b_class="alert alert-danger")}).catch(e=>{console.log(e.response)})}else this.b_class="alert alert-danger",this.b_message="Select an image file not more than 10MB"},getServices(){axios.post("http://localhost/gym_cms/index.php/GetBanners").then(e=>{banner=e.data.filter(e=>"service"==e.page),banner.length>0&&(this.hasBanner=!0,this.banner=banner[0].link)}),axios.post("http://localhost/gym_cms/index.php/GetServices").then(e=>{this.services=e.data})},addService(){let e="",t=!0;if(this.valid_file(this.service_image,2)||(e+="Upload valid image file not more than 2MB<br/>",t&=!1),this.title||(e+="Enter a title<br/>",t&=!1),this.description||(e+="Describe the service<br/>",t&=!1),t){this.message="";let e=this.toFormData({title:this.title,description:this.description,details:this.details.split("\n").join(","),image:this.service_image});axios.post("http://localhost/gym_cms/index.php/AddService",e).then(e=>{e.data.status?(this.services=e.data.services,this.shrinkTable=!1):this.message=":( Operation Failed."}).catch(e=>{console.log(e.response)})}else this.message=e},deleteService(e){swal({title:"Delete?",text:"Are you sure you want to delete this service ?",closeOnClickOutside:!1,buttons:{cancel:{className:"btn btn-default",text:"Cancel",visible:!0},confirm:{className:"btn btn-danger",text:"Yes, Delete",visible:!0,value:"delete"}}}).then(t=>{"delete"==t&&(this.services=this.services.filter(t=>t.serial!=e),axios.post("http://localhost/gym_cms/index.php/RemoveService",this.toFormData({serial:e})))})},valid_file:(e,t)=>!!e&&e.size/1024/1024<=t,toFormData(e){let t=new FormData;for(key in e)t.append(key,e[key]);return t},separate:e=>e.replace(/\,/g,"<br/>")},mounted(){this.getServices()}});