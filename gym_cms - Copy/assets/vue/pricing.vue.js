function editPricing(t){app.showEditPricing(t)}function deletePricing(t){app.deletePricing(t)}function editArt(t){app.showEditArticle(t)}function deleteArt(t){app.deleteArticle(t)}var app=new Vue({el:"#app",data:{hasBanner:!1,banner:"",b_message:"",b_class:"alert alert-danger",progress:0,newPricing:!1,newArticle:!1,p_title:"",currency:"",duration:"",amount:"",description:"",a_title:"",article:"",p_message:"",a_message:"",pricingUrl:"http://localhost/gym_cms/index.php/AddPricing",articleUrl:"http://localhost/gym_cms/index.php/AddPricingArticle"},methods:{changeFile(t,e){this.banner=t.target.files[0]},changeBanner(){this.hasBanner=!1},showPanel(t){this.newPricing="pricing"==t,this.newArticle="article"==t},showEditPricing(t){this.pricingUrl=`http://localhost/gym_cms/index.php/EditPricing/${t}`,axios.post(`http://localhost/gym_cms/index.php/GetPricing/${t}`).then(t=>{this.p_title=t.data.title,this.currency=t.data.currency,this.description=t.data.description.replace(/\,/g,"\n"),this.amount=t.data.amount,this.duration=t.data.duration,this.showPanel("pricing")}).catch(t=>{console.log(t)})},showEditArticle(t){this.articleUrl=`http://localhost/gym_cms/index.php/EditPricingArticle/${t}`,axios.post(`http://localhost/gym_cms/index.php/GetPricingArticle/${t}`).then(t=>{this.a_title=t.data.title,this.article=t.data.article,this.showPanel("article")}).catch(t=>{console.log(t)})},getPricings(){$("#p_table").DataTable({serverSide:!0,ajax:{url:"http://localhost/gym_cms/index.php/GetPricings",type:"post",error:function(t){console.log(t.responseText)}}}),axios.post("http://localhost/gym_cms/index.php/GetBanners").then(t=>{banner=t.data.filter(t=>"pricing"==t.page),banner.length>0&&(this.hasBanner=!0,this.banner=banner[0].link)})},getArticles(){$("#a_table").DataTable({serverSide:!0,ajax:{url:"http://localhost/gym_cms/index.php/GetPricingArticles",type:"post",error:function(t){console.log(t.responseText)}}})},valid_file:(t,e)=>!!t&&t.size/1024/1024<=e,uploadBanner(){if(this.valid_file(this.banner,10)){this.b_message="";const t={onUploadProgress:function(t){app.progress=Math.round(t.loaded/t.total*100)}};let e=this.toFormData({image:this.banner});axios.post("http://localhost/gym_cms/index.php/UploadBanner/pricing",e,t).then(t=>{t.data.status?(this.progress=0,this.banner=t.data.file,this.hasBanner=!0):(this.b_message=t.data.message,this.b_class="alert alert-danger")}).catch(t=>{console.log(t.response)})}else this.b_class="alert alert-danger",this.b_message="Select an image file not more than 10MB"},savePricing(){let t="",e=!0;if(this.p_title||(t+="Enter a title <br/>",e&=!1),this.currency||(t+="Enter a currency <br/>",e&=!1),this.amount||(t+="Enter an amount <br/>",e&=!1),this.duration||(t+="Enter a duration <br/>",e&=!1),this.description||(t+="Enter a description <br/>",e&=!1),e){let t=this.toFormData({title:this.p_title,amount:this.amount,description:this.description.replace(/\n/g,","),currency:this.currency,duration:this.duration});axios.post(this.pricingUrl,t).then(t=>{t.data.status?app.closePanel():this.p_message="Operation Failed :("})}else this.p_message=t},deletePricing(t){swal({title:"Delete?",text:"Are you sure you want to delete ?",closeOnClickOutside:!1,buttons:{cancel:{className:"btn btn-default",text:"Cancel",visible:!0},confirm:{className:"btn btn-danger",text:"Yes, Delete",visible:!0,value:"delete"}}}).then(e=>{"delete"==e&&axios.post(`http://localhost/gym_cms/index.php/DeletePricing/${t}`).then(t=>{$("#p_table").DataTable().ajax.reload()})})},saveArticle(){let t="",e=!0;if(this.a_title||(t+="Enter Title <br/>",e&=!1),this.article||(t+="Enter Article Content",e&=!1),e){let t=this.toFormData({article:this.article,title:this.a_title});axios.post(this.articleUrl,t).then(t=>{t.data.status?app.closePanel():this.a_message="Operation Failed :("}).catch(t=>{console.log(t)})}else this.a_message=t},deleteArticle(t){swal({title:"Delete?",text:"Are you sure you want to delete ?",closeOnClickOutside:!1,buttons:{cancel:{className:"btn btn-default",text:"Cancel",visible:!0},confirm:{className:"btn btn-danger",text:"Yes, Delete",visible:!0,value:"delete"}}}).then(e=>{"delete"==e&&axios.post(`http://localhost/gym_cms/index.php/DeletePricingArticle/${t}`).then(t=>{$("#a_table").DataTable().ajax.reload()})})},toFormData(t){let e=new FormData;for(key in t)e.append(key,t[key]);return e},closePanel(){this.newPricing=!1,this.newArticle=!1,this.title="",this.currency="",this.duration="",this.description="",this.amount="",this.a_title="",this.article="",this.savePricing="http://localhost/gym_cms/index.php/AddPricing",this.saveArticle="http://localhost/gym_cms/index.php/AddPricingArticle",$("#p_table").DataTable().ajax.reload(),$("#a_table").DataTable().ajax.reload()}},mounted(){this.getPricings(),this.getArticles()}});